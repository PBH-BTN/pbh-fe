import{u as $}from"./index-DF4D1ORJ.js";import{e as T,a6 as E,r as g,ah as S,o as C,h as I,q as V,C as o,v as t,y as c,N as d}from"./libs-tLzij8UM.js";import{b as x,h as D,ai as L,F as N,aj as j,L as q,B as A,t as M,S as H,v as R,w as O}from"./arcoDesign-DCmKwCeN.js";import{I as U}from"./index-HmxKNo6q.js";const W=T({__name:"index",setup(z){const k=$(),{t:v}=E(),l=g(!1),a=g({rememberPassword:!0,token:k.authToken}),s=g(),w=async({errors:e,values:r})=>{var n,m,u;const i=e?Object.keys(e):[];if(i.length>0){(n=s.value)==null||n.scrollToField(i[0]);return}const{token:f,rememberPassword:_}=r;if(!l.value){l.value=!0,(m=s.value)==null||m.setFields({token:{status:"validating",message:""}});try{await k.setAuthToken(f,_),x.success(v("login.form.login.success"))}catch(p){(u=s.value)==null||u.setFields({token:{status:"error",message:`${v("login.form.login.failed")}  ${p.message}`}})}finally{l.value=!1}}},{query:h}=S();return C(()=>{var e;h.token&&(a.value.token=h.token,(e=s.value)==null||e.$emit("submit",{values:a.value,errors:void 0},new Event("submit")))}),(e,r)=>{const i=D,f=U,_=L,n=N,m=j,u=q,p=A,b=M,y=H,P=R,B=O;return I(),V(B,{justify:"center"},{default:o(()=>[t(P,{xs:24,sm:20,md:16,lg:12,xl:8},{default:o(()=>[t(y,{direction:"vertical",fill:""},{default:o(()=>[t(i,{heading:3},{default:o(()=>[c(d(e.$t("login.form.title")),1)]),_:1}),t(b,{ref_key:"loginForm",ref:s,model:a.value,class:"login-form",layout:"vertical",onSubmit:w},{default:o(()=>[t(n,{field:"token",rules:[{required:!0,message:e.$t("login.form.password.errMsg")}],"validate-trigger":["change","input"],"hide-label":""},{default:o(()=>[t(_,{modelValue:a.value.token,"onUpdate:modelValue":r[0]||(r[0]=F=>a.value.token=F),placeholder:e.$t("login.form.password.placeholder"),"allow-clear":""},{prefix:o(()=>[t(f)]),_:1},8,["modelValue","placeholder"])]),_:1},8,["rules"]),t(n,{field:"rememberPassword",class:"login-form-password-actions"},{default:o(()=>[t(m,{checked:"rememberPassword","model-value":a.value.rememberPassword},{default:o(()=>[c(d(e.$t("login.form.rememberPassword")),1)]),_:1},8,["model-value"]),t(u,{style:{marginLeft:"auto"},href:"https://github.com/PBH-BTN/PeerBanHelper/wiki/%E5%A6%82%E4%BD%95%E9%87%8D%E7%BD%AEToken"},{default:o(()=>[c(d(e.$t("login.form.forgetPassword")),1)]),_:1})]),_:1}),t(p,{type:"primary","html-type":"submit",long:"",loading:l.value},{default:o(()=>[c(d(e.$t("login.form.login")),1)]),_:1},8,["loading"])]),_:1},8,["model"])]),_:1})]),_:1})]),_:1})}}});export{W as default};
